# Claude Code Resume Context - WOPR Project

## Last Updated: 2026-01-19

## Project Location
`/home/corey/source/repos/personal/WOPR`

## Current State
Branch: `feature/gtw3` - Contains enhanced Global Thermonuclear War implementation

### Recent Work Completed:
1. **GTW Visual Enhancements** (feature/gtw3 branch):
   - Implemented Drawille braille library for high-resolution missile arc rendering
   - Added red missile trails using Textual markup
   - Added red X impact markers for nuclear strike locations
   - Implemented single-map animation with clear_callback (smooth animation)
   - Added arc space (8 character rows) above map for full trajectory visibility
   - Fixed Drawille canvas.frame() alignment issue (offset handling)
   - Updated coordinates with Y_OFFSET=32 for proper arc space positioning

2. **Documentation Updates**:
   - Updated README.md with GTW visual features documentation
   - Added drawille to dependencies in install.py and pyproject.toml
   - Added technical implementation notes for Drawille in README

3. **Test Suite**:
   - All 76 unit tests passing
   - All 16 games pass regression testing
   - GTW changes isolated to thermonuclear_war module - no impact on other games

## Key Files Modified (feature/gtw3):
- `wopr/games/military/thermonuclear_war/drawille_map.py` - NEW: Drawille braille map rendering
- `wopr/games/military/thermonuclear_war/game.py` - Added clear_callback for single-map animation
- `wopr/games/military/thermonuclear_war/map.py` - Updated coordinate system
- `wopr/app.py` - Passes clear_callback to GTW game
- `README.md` - GTW documentation and dependencies
- `install.py` - Added drawille dependency
- `pyproject.toml` - Added drawille dependency
- `tests/test_games/test_gtw.py` - Updated tests for new API
- `tests/test_games/test_tictactoe.py` - Fixed assertion for learning output

## Technical Notes

### Drawille Implementation (CRITICAL for GTW):
```python
# Key concepts for missile arc rendering:

# 1. Coordinate System with Arc Space
Y_OFFSET = 32      # Pixels to shift coordinates down
ARC_ROWS = 8       # Character rows above map for arc display
CANVAS_HEIGHT = 128  # Extended canvas height

# 2. All city LOCATIONS have Y coordinates shifted by Y_OFFSET
"MOSCOW": (110, 44),  # Original y=12, shifted by 32

# 3. canvas.frame() alignment (CRITICAL)
# Drawille's canvas.frame() only returns rows WITH content
# Track min_y and use as offset when overlaying
min_y_char = min_y_pixel // 4
actual_row = dy + min_y_char

# 4. Textual markup escaping (NOT like Rich)
# Use \[ to escape brackets, not [[
```

## Repository Info
- GitHub: https://github.com/c88951/WOPR
- Main branch: `main` (protected)
- Feature branch: `feature/gtw3` (ready for merge after approval)

## Next Steps
1. Merge feature/gtw3 to main (after user approval)
2. Consider cleaning up unused assets (e.g., `wopr/assets/maps/world_ascii.txt`)

## Resume Instructions
Tell Claude: "Resume from .claude-resume.md in the WOPR project"
